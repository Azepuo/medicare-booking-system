<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">

    <title>HealthAdmin - Modifier RDV</title>
</head>

<body>

<section id="sidebar">
    <!-- ... sidebar inchangée ... -->
</section>

<section id="content">

    <nav>
        <!-- ... navbar inchangée ... -->
    </nav>

    <main>
        <div class="head-title">
            <div class="left">
                <h1>Modifier un rendez-vous</h1>
                <ul class="breadcrumb">
                    <li><a href="/admin/dashboard">Dashboard</a></li>
                    <li><i class='bx bx-chevron-right'></i></li>
                    <li><a href="/admin/rendez_vous">Rendez-vous</a></li>
                    <li><i class='bx bx-chevron-right'></i></li>
                    <li><a class="active" href="#">Modifier</a></li>
                </ul>
            </div>
        </div>

        <div class="form-wrapper">
            <div class="form-card form-card-medium">
                <h2>Informations du rendez-vous</h2>

                <!-- ✅ IMPORTANT : bonne route + POST -->
                <form method="POST" action="{{ url_for('rdv_bp.editer_rdv', rdv_id=rdv.id) }}">
                    <div class="form-grid">

                        <!-- ✅ Patient -->
                        <div class="field">
                            <label for="patient_id">Patient</label>
                            <select id="patient_id" name="patient_id" required>
                                <option value="">-- Sélectionner un patient --</option>
                                {% for p in patients %}
                                <option value="{{ p.id }}"
                                    {% if rdv.patient_id == p.id %}selected{% endif %}>
                                    {{ p.nom }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <!-- ✅ Médecin -->
                        <div class="field">
                            <label for="medecin_id">Médecin</label>
                            <select id="medecin_id" name="medecin_id" required>
                                <option value="">-- Sélectionner un médecin --</option>
                                {% for m in medecins %}
                                <option value="{{ m.id }}"
                                    {% if rdv.medecin_id == m.id %}selected{% endif %}>
                                    Dr. {{ m.nom }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <!-- ✅ Date -->
                        <div class="field">
                            <label for="date_rdv">Date</label>
                            <input type="date" id="date_rdv" name="date_rdv"
                                   value="{{ rdv.date_rdv }}" required>
                        </div>

                        <!-- ✅ Heure -->
                        <div class="field">
                            <label for="heure_rdv">Heure</label>
                            <input type="time" id="heure_rdv" name="heure_rdv"
                                   value="{{ rdv.heure_rdv }}" required>
                        </div>

                        <!-- ✅ Statut -->
                        <div class="field">
                            <label for="statut">Statut</label>
                            <select id="statut" name="statut">
                                <option value="en_attente"
                                    {% if rdv.statut == 'en_attente' %}selected{% endif %}>
                                    En attente
                                </option>
                                <option value="terminé"
                                    {% if rdv.statut == 'terminé' %}selected{% endif %}>
                                    Terminé
                                </option>
                                <option value="annulé"
                                    {% if rdv.statut == 'annulé' %}selected{% endif %}>
                                    Annulé
                                </option>
                            </select>
                        </div>

                        <!-- ✅ Notes -->
                        <div class="field field-full">
                            <label for="notes">Motif / Notes</label>
                            <textarea id="notes" name="notes" rows="3">{{ rdv.notes }}</textarea>
                        </div>

                    </div>

                    <div class="form-actions">
                        <a href="/admin/rendez_vous" class="btn-secondary">Annuler</a>
                        <button type="submit" class="btn-primary">Enregistrer</button>
                    </div>

                </form>
            </div>
        </div>

    </main>

</section>

<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>

</html>
