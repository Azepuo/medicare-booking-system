{% extends "medecin/base.html" %}

{% block title %}Agenda • Médecin{% endblock %}

{% block body_id %}agenda-page{% endblock %}

{% block content %}
<div class="header-row">
  <h1 class="h1">Agenda Hebdomadaire</h1>
  <div style="display: flex; gap: 10px;">
    <button class="btn secondary" onclick="previousWeek()">
      <i class="fas fa-chevron-left"></i> Semaine précédente
    </button>
    <button class="btn secondary" onclick="nextWeek()">
      Semaine suivante <i class="fas fa-chevron-right"></i>
    </button>
    <button class="btn" onclick="goToToday()">
      <i class="fas fa-calendar-day"></i> Aujourd'hui
    </button>
  </div>
</div>

<!-- Sélecteur de date -->
<div class="card" style="margin-bottom: 20px;">
  <div style="text-align: center; font-size: 18px; font-weight: bold;">
    Semaine du 15 janvier 2024
  </div>
</div>

<!-- Grille de l'agenda -->
<div class="agenda-grid">
  <!-- En-têtes des jours -->
  <div class="agenda-header">Heure</div>
  <div class="agenda-header">Lun 15</div>
  <div class="agenda-header">Mar 16</div>
  <div class="agenda-header">Mer 17</div>
  <div class="agenda-header">Jeu 18</div>
  <div class="agenda-header">Ven 19</div>
  <div class="agenda-header">Sam 20</div>

  <!-- Créneaux horaires -->
  {% for hour in range(8, 19) %}
    <div class="agenda-time">{{ hour }}:00</div>
    {% for day in range(1, 7) %}
      <div class="agenda-slot" data-hour="{{ hour }}" data-day="{{ day }}">
        {% if hour == 9 and day == 1 %}
          <div class="agenda-event" style="background: var(--blue-100); border-left: 3px solid var(--blue-500);">
            <strong>Marie Dupont</strong>
            <div class="small">Consultation</div>
          </div>
        {% elif hour == 10 and day == 1 %}
          <div class="agenda-event" style="background: #e6f7ff; border-left: 3px solid #1890ff;">
            <strong>Pierre Martin</strong>
            <div class="small">Suivi</div>
          </div>
        {% elif hour == 14 and day == 2 %}
          <div class="agenda-event" style="background: #f6ffed; border-left: 3px solid #52c41a;">
            <strong>Sophie Lambert</strong>
            <div class="small">Vaccination</div>
          </div>
        {% elif hour == 11 and day == 3 %}
          <div class="agenda-event" style="background: #fff7e6; border-left: 3px solid #fa8c16;">
            <strong>Réunion</strong>
            <div class="small">Staff médical</div>
          </div>
        {% endif %}
      </div>
    {% endfor %}
  {% endfor %}
</div>

<!-- Légende -->
<div class="card" style="margin-top: 20px;">
  <h3>Légende</h3>
  <div style="display: flex; gap: 20px; flex-wrap: wrap;">
    <div style="display: flex; align-items: center; gap: 8px;">
      <div style="width: 12px; height: 12px; background: var(--blue-500); border-radius: 2px;"></div>
      <span>Consultations</span>
    </div>
    <div style="display: flex; align-items: center; gap: 8px;">
      <div style="width: 12px; height: 12px; background: #1890ff; border-radius: 2px;"></div>
      <span>Suivi patients</span>
    </div>
    <div style="display: flex; align-items: center; gap: 8px;">
      <div style="width: 12px; height: 12px; background: #52c41a; border-radius: 2px;"></div>
      <span>Vaccinations</span>
    </div>
    <div style="display: flex; align-items: center; gap: 8px;">
      <div style="width: 12px; height: 12px; background: #fa8c16; border-radius: 2px;"></div>
      <span>Réunions</span>
    </div>
  </div>
</div>

<!-- Statistiques de la semaine -->
<div class="grid" style="margin-top: 20px;">
  <div class="card">
    <h3>RDV Cette Semaine</h3>
    <p>24</p>
  </div>
  <div class="card">
    <h3>Heures de Consultations</h3>
    <p>18h</p>
  </div>
  <div class="card">
    <h3>Taux de Remplissage</h3>
    <p>85%</p>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function previousWeek() {
  alert('Semaine précédente');
  // Logique pour charger la semaine précédente
}

function nextWeek() {
  alert('Semaine suivante');
  // Logique pour charger la semaine suivante
}

function goToToday() {
  alert('Retour à aujourd\'hui');
  // Logique pour revenir à la semaine actuelle
}

// Gestion des clics sur les créneaux
document.querySelectorAll('.agenda-slot').forEach(slot => {
  slot.addEventListener('click', function() {
    const hour = this.dataset.hour;
    const day = this.dataset.day;
    const days = ['Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'];
    
    if (confirm(`Créer un rendez-vous le ${days[day-1]} à ${hour}:00 ?`)) {
      // Ouvrir un formulaire de création de RDV
    }
  });
});
</script>

<style>
.agenda-grid {
  display: grid;
  grid-template-columns: 80px repeat(6, 1fr);
  gap: 1px;
  background: #f1f6fb;
  border: 1px solid #f1f6fb;
  border-radius: 8px;
  overflow: hidden;
}

.agenda-header {
  background: var(--blue-100);
  padding: 12px;
  text-align: center;
  font-weight: bold;
  color: var(--text);
}

.agenda-time {
  background: white;
  padding: 12px;
  text-align: center;
  font-size: 14px;
  color: var(--muted);
  border-right: 1px solid #f1f6fb;
}

.agenda-slot {
  background: white;
  min-height: 60px;
  padding: 4px;
  border-right: 1px solid #f1f6fb;
  border-bottom: 1px solid #f1f6fb;
  cursor: pointer;
  transition: background 0.2s;
}

.agenda-slot:hover {
  background: #fafafa;
}

.agenda-event {
  padding: 6px;
  border-radius: 4px;
  font-size: 12px;
  margin-bottom: 2px;
}
</style>
{% endblock %}