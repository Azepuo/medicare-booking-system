{% extends "patient/base.html" %}
{% block title %}Rendez-vous{% endblock %}
{% set active_page = 'mes_rdv' %}

{% block content %}
<div class="content">
    <div class="container">
        <div class="heade">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h1>Historique des Rendez-vous</h1>
                <button class="btn-add-appointment" onclick="showAppointmentForm()">
                    <i class="fas fa-plus" style="color: white;"></i> Ajouter un Rendez-vous
                </button>
            </div>

            <div class="filters">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Rechercher par m√©decin, sp√©cialit√© ou date...">
                </div>
                <div class="filter-buttons">
                    <button class="filter-btn active" data-filter="tous">Tous</button>
                    <button class="filter-btn" data-filter="confirm√©">Confirm√©s</button>
                    <button class="filter-btn" data-filter="termin√©">Termin√©s</button>
                    <button class="filter-btn" data-filter="annul√©">Annul√©s</button>
                    <button class="filter-btn" data-filter="attente">En Attente</button>
                </div>
            </div>
        </div>

        <div id="stats" class="stats"></div>

        <div id="appointmentsGrid" class="appointments-grid"></div>

        <!-- Empty state, toujours pr√©sent -->
        <div id="emptyState" class="empty-state" style="display:none;">
            <div class="empty-state-icon">üìÖ</div>
            <h3>Aucun rendez-vous trouv√©</h3>
            <p>Essayez de modifier vos crit√®res de recherche</p>
        </div>

    </div>
</div>

{% include "patient/prise_rdv.html" %}

{% endblock %}

{% block scripts %}
<script>
    // ‚úÖ Tableau JS √† partir des donn√©es Flask
    const appointments = [
        {% for rdv in upcoming_appointments %}
        {
            id: {{ rdv.id }},
            medecin_name: "{{ rdv.medecin_nom }}",
            medecin_spec: "{{ rdv.specialite }}",
            date: "{{ rdv.date_heure.strftime('%Y-%m-%d') }}",
            time: "{{ rdv.date_heure.strftime('%H:%M') }}",
            clinic: "{{ rdv.clinic or '' }}",
            status: "{{ rdv.statut | lower }}"
        },
        {% endfor %}
    ];
</script>
<script src="{{ url_for('static', filename='js/patient.js') }}"></script>
{% endblock %}
